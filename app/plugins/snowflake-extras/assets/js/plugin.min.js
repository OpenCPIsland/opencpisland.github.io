/*! Snowflake Extras Plugin
 * https://github.wdig.com/clubpenguin/tm-plugin-snowflake-extras
 * Copyright (c) 2018; * Licensed GPL-2.0+ */
function SnowflakeWebviewEventListener(a,b){console.log("event: %o",a),console.log("data: %o",b)}var SNOWFLAKE=SNOWFLAKE||{},SNOWFLAKE_X=SNOWFLAKE_X||{};!function(a){SNOWFLAKE_X={common:{init:function(){SNOWFLAKE_X.App.init();SNOWFLAKE_X.Widgets.init();SNOWFLAKE.ClickEffects(a(".slick-dots button, .slick-slider .slick-prev, .slick-slider .slick-next")).listeners()},finalize:function(){}},page:{init:function(){SNOWFLAKE_X.Kaltura.init()}},single_snowflake_video:{init:function(){SNOWFLAKE_X.Kaltura.init();SNOWFLAKE.LoadPosts.init("#video-loader",snowflake_extras.post_id,snowflake_extras.video_cat),SNOWFLAKE.LoadPosts.categoryFilters()}},social_post:{init:function(){if(a(".sf-slider .sf-slide").length>1){var b=a(".sf-slider").data("autoplay");a(".sf-slider").slick({arrows:!1,dots:!0,pauseOnDotsHover:!0,focusOnSelect:!0,autoplay:b,autoplaySpeed:4e3}),a(".sf-post-wrapper").on("focus",function(){a(this).find(".sf-slider").slick("slickPause")}),a("body").on("animPause",function(b){a(".sf-slider").slick("slickPause")})}}}};var b={fire:function(a,b,c){var d,e=SNOWFLAKE_X;b=void 0===b?"init":b,d=""!==a,d=d&&e[a],(d=d&&"function"==typeof e[a][b])&&e[a][b](c)},loadEvents:function(){b.fire("common"),a.each(document.body.className.replace(/-/g,"_").split(/\s+/),function(a,c){b.fire(c),b.fire(c,"finalize")}),b.fire("common","finalize")}};a(document).ready(b.loadEvents)}(jQuery),function(a){SNOWFLAKE_X.AjaxStates={isInProgress:!1,isError:!1,init:function(){var a=this;a.debug="true"==snowflake_data.debug,SNOWFLAKE_X.App.isAppView?a.notifications=SNOWFLAKE_X.Notifications.add("page",!0,a.debug):a.notifications=SNOWFLAKE_X.Notifications.add("console",!1,a.debug),a.listeners()},listeners:function(){var b=this;a(document).ajaxStart(function(){b.isInProgress=!0,b.isError=!1}),a(document).ajaxSend(function(a,b,c){}),a(document).ajaxSuccess(function(a,b,c){}),a(document).ajaxComplete(function(c,d,e){b.isInProgress=!1,a("body").trigger("sfAjaxComplete",[e])}),a(document).ajaxStop(function(){a("body").trigger("sfAjaxDone")}),a(document).ajaxError(function(c,d,e,f){b.notifications.set("ajaxError"),b.notifications.set(f),console.error(f),console.log(d),console.log(e),b.isError=!0,b.isInProgress=!1,a("body").trigger("sfAjaxError",[e,f])})}},a(document).ready(function(){SNOWFLAKE_X.AjaxStates.init()})}(jQuery),function(a){SNOWFLAKE_X.App={isAppView:!1,isAppDebug:!1,appType:"",appEndpoint:"",dlBtnMulti_s:".app-download",dlBtnIOS_s:".app-download-ios",dlBtnAndroid_s:".app-download-android",dlBtnMacos_s:".app-download-macos",dlBtnWindows_s:".app-download-windows",dlBtnWindows64_s:".app-download-windows-64",init:function(){this.appEndpointSetup()},appEndpointSetup:function(){var a=this;void 0!==snowflake_extras.app_view&&void 0!==snowflake_extras.app_view.app&&(a.isAppView=!0,a.isAppDebug=!!snowflake_extras.app_view.debug,a.appType=snowflake_extras.app_view.app,a.appEndpoint="app/"+a.appType+"/")},updateInstallerUrls:function(b){var c=this;c.process=b,c.currentId=c.process.actionId,c.currentAction=c.process.actions[c.currentId],c.installers=c.currentAction.installers,void 0===c.installers||a.isEmptyObject(c.installers)||(snowflake_extras.app.installers=c.installers,void 0!==snowflake_extras.app.installers.macos&&""!==a.trim(snowflake_extras.app.installers.macos)&&a(c.dlBtnMacos_s).each(function(){a(this).attr("href",snowflake_extras.app.installers.macos)}),void 0!==snowflake_extras.app.installers.windows&&""!==a.trim(snowflake_extras.app.installers.windows)&&a(c.dlBtnWindows_s).each(function(){a(this).attr("href",snowflake_extras.app.installers.windows)}),void 0!==snowflake_extras.app.installers.windows_64&&""!==a.trim(snowflake_extras.app.installers.windows_64)&&a(c.dlBtnWindows64_s).each(function(){a(this).attr("href",snowflake_extras.app.installers.windows_64)})),SF_DISNEYID.actions.nextActionStep(c.process,c.currentId)},updateMultiPlatformButtons:function(b){a("body").trigger("updateMultiButtons")}}}(jQuery),function(a){SNOWFLAKE_X.Kaltura=function(b){return b.init=function(){var b=this;this.accessibility={autoplay:!0,automute:!0},this.unavailableText="Unable to load video.",this.kWidgetIsAvailable=!0,"undefined"==typeof kWidget&&(this.kWidgetIsAvailable=!1),this.postVideoHolder=a(".sf-post-video .video-holder"),this.postVideoHolder.each(function(){b.kWidgetIsAvailable?b.videoPost(a(this)):b.unavailable(a(this))}),this.eteVideoHolder=a(".sf-etevideo .video-holder"),this.eteVideoHolder.each(function(){b.kWidgetIsAvailable?b.eteVideo(a(this)):b.unavailable(a(this))})},b.videoPost=function(a){kWidget.embed({targetId:a.find(".sf-kaltura-video").attr("id"),wid:"_"+snowflake_extras.kaltura.partner_id,uiconf_id:snowflake_extras.kaltura.player_id,entry_id:a.data("vid"),accessibilityButtons:{plugin:!0,positionBtn:!0,forwardBtn:!0,backwardBtn:!0},flashvars:{"closedCaptions.defaultLanguageKey":snowflake_extras.kaltura.cc_language,"closedCaptionsOverPlayer.defaultLanguageKey":snowflake_extras.kaltura.cc_language},readyCallback:function(a){}}),mw.setConfig("Kaltura.LeadWithHTML5",!0)},b.eteVideo=function(b){var c=this;a("body").on("animPause",function(){a(this).trigger("stopVideoAutoplay")}).on("stopVideoAutoplay",function(){c.toggleAutoplay(!1)}),this.player={fullscreen:!1,autoplay:c.accessibility.autoplay,playing:!0,muted:c.accessibility.automute},this.videoControls={wrapper:a(".sf-etevideo .video-controls"),play:a(".sf-etevideo .play"),sound:a(".sf-etevideo .sound"),fullscreen:a(".sf-etevideo .full")},kWidget.embed({targetId:b.find(".sf-kaltura-video").attr("id"),wid:"_"+snowflake_extras.kaltura.partner_id,uiconf_id:snowflake_extras.kaltura.player_id,entry_id:b.data("vid"),flashvars:{autoPlay:c.accessibility.autoplay,autoMute:c.accessibility.automute,loop:!0,"controlBarContainer.plugin":!0,"largePlayBtn.plugin":!0,"loadingSpinner.plugin":!0,IframeCustomPluginCss1:snowflake_extras.kaltura.css_override,"closedCaptions.defaultLanguageKey":snowflake_extras.kaltura.cc_language,"closedCaptionsOverPlayer.defaultLanguageKey":snowflake_extras.kaltura.cc_language},readyCallback:function(a){c.kdp=document.getElementById(a),c.kdp.kBind("playerPlayed",function(){c.player.playing=!0,c.videoControls.play.removeClass("pause")}),c.kdp.kBind("playerPaused",function(){c.player.playing=!1,c.videoControls.play.addClass("pause")}),c.kdp.kBind("openFullScreen",function(){c.player.fullscreen=!0,c.videoControls.fullscreen.addClass("up")}),c.kdp.kBind("closeFullScreen",function(){c.player.fullscreen=!1,c.videoControls.fullscreen.removeClass("up")}),c.kdp.kBind("mute",function(){c.player.muted=!0,c.videoControls.sound.addClass("off")}),c.kdp.kBind("unmute",function(){c.player.muted=!1,c.videoControls.sound.removeClass("off")}),c.player.autoplay=c.kdp.evaluate("{autoPlay}"),c.player.autoplay?SNOWFLAKE.Browser.isIOS||c.videoControls.wrapper.fadeIn():c.videoControls.wrapper.hide(),c.videoControls.play.on("click",function(a){a.preventDefault(),c.toggleAutoplay(!c.player.playing)}),c.videoControls.sound.on("click",function(a){a.preventDefault(),c.player.muted?c.kdp.sendNotification("changeVolume",.75):c.kdp.sendNotification("changeVolume",0)}),c.videoControls.fullscreen.on("click",function(a){a.preventDefault(),c.player.fullscreen?(c.kdp.sendNotification("closeFullScreen"),c.kdp.sendNotification("enableGui",{guiEnabled:!1})):(c.kdp.sendNotification("openFullScreen"),c.kdp.sendNotification("enableGui",{guiEnabled:!0}))})}}),mw.setConfig("Kaltura.LeadWithHTML5",!0)},b.toggleAutoplay=function(a){var b=this;b.accessibility.autoplay=a,b.accessibility.autoplay?b.kdp.sendNotification("doPlay"):b.kdp.sendNotification("doPause")},b.unavailable=function(a){var b=this;a.addClass("no-video").find(".sf-kaltura-video").text(b.unavailableText)},b}(SNOWFLAKE_X.Kaltura||{})}(jQuery),function(a){SNOWFLAKE_X.Notifications={displayNotifications:!1,displayType:"console",message:"",messageWrap_m:'<div class="message [[classes]]" style="display:none;"><div class="close"><a href="#">X</a></div><div class="inner">[[message]]</div></div>',message_c:"message",pageNotification_c:"page-notification",pageWrapper_s:".sf-page",statusWaiting_s:".message.waiting",appendNew:!0,init:function(){var a=this;a.pageNotification_s="#"+a.pageNotification_c,a.message_s="."+a.message_c,a.close_s=a.message_s+" .close a",SNOWFLAKE_X.App.isAppView&&(a.displayNotifications=SNOWFLAKE_X.App.isAppDebug),a.reset(),a.listeners()},listeners:function(){var b=this;a("body").on("click",b.pageNotification_s+" "+b.close_s,function(c){c.preventDefault(),a(this).parents(b.message_s+":eq(0)").remove()})},add:function(b,c,d){var e=this;return"boolean"==typeof d&&(e.displayNotifications=d),void 0===b||"alert"!=b&&"console"!=b&&"page"!=b||(e.displayType=b),"boolean"==typeof c&&(e.appendNew=c),"page"!=e.displayType||a(e.pageNotification_s).length||a(e.pageWrapper_s).prepend('<div id="'+e.pageNotification_c+'"></div>'),this},set:function(b,c,d,e){var f=this;if(f.displayNotifications&&void 0!==b)switch(f.reset(),void 0!==c&&(f.status=c),"boolean"==typeof d&&(f.animate=d),"boolean"==typeof e&&a(f.pageNotification_s).find(f.statusWaiting_s).remove(),f.classes.push(f.status),f.animate&&f.classes.push("pulseSmall"),f.appendNew||f.clear(),f.message=b,f.displayType){case"alert":"object"==typeof f.message&&(f.message=JSON.stringify(f.message)),alert(f.message);break;case"console":console.log(f.message);break;case"page":"object"==typeof f.message&&(f.message=JSON.stringify(f.message)),f.message=f.messageWrap_m.replace("[[message]]",f.message),f.message=f.message.replace("[[classes]]",f.classes.join(" ")),a(f.pageNotification_s).append(f.message),a(f.pageNotification_s).find(f.message_s+":last-child").slideToggle()}},reset:function(){var a=this;a.classes=[],a.animate=!1,a.status="info"},clear:function(){var b=this;"page"==b.displayType&&a(b.pageNotification_s).find(b.message_s).remove()}},a(document).ready(function(){SNOWFLAKE_X.Notifications.init()})}(jQuery),function(a){SNOWFLAKE_X.WebviewEventComm={isZF:!1,isUni:!1,init:function(){var a=this;if(SNOWFLAKE_X.App.isAppView)switch(SNOWFLAKE_X.App.appType){case"macos":case"windows":case"linux":a.isZF=!0;break;case"ios":case"android":a.isUni=!0}a.reset(),a.isCommEnabled&&(a.listeners(),a.notifications=SNOWFLAKE_X.Notifications.add("page"))},listeners:function(){var b=this;b.isUni&&a("body").on("click",b.commBtn_s,function(c){b.notifications.set("btn clicked: "+a(this).attr("href"))}),a("body").on("appLoginStatus",function(a,c){b.type="loginStatus",b.args={status:"success"==c.status?"1":"0",msg:c.status},b.send()}),a("body").on("appLoginSuccess",function(a,c){b.type="login",b.args={status:"1",msg:"success"},b.send()}),a("body").on("appLoginFailure",function(a,c){b.type="login",b.args={status:"0",msg:"error"},b.send()})},send:function(b,c,d){var e=this;e.isCommEnabled&&(void 0!==b&&(e.type=b),void 0!==c&&(e.args=c),void 0!==d&&(e.schema=d),e.isZF?(e.argsJSON=JSON.stringify(e.args),window[e.callback].call(e,e.type,e.argsJSON),e.notifications.set("callback called - arg(1): "+e.type+"; arg(2): "+e.argsJSON)):e.isUni&&(e.argsComm=a.param(e.args),a(e.commBtn_s).attr("href",e.schema+e.type+"?"+e.argsComm).click()),e.reset())},reset:function(){var b=this;b.isCommEnabled=b.isZF||b.isUni,b.type="",b.args={},b.argsComm="",b.argsJSON="",b.href="",b.schema="uniwebview://",b.commBtnId="webviewEventComm",b.commBtn_s="#"+b.commBtnId,b.markup='<a id="'+b.commBtnId+'" href="#" style="display:none;"><span>Event Communicator</span></a>',!a(b.commBtn_s).length&&b.isUni&&a("body").prepend(b.markup),b.callback="webviewEventListener","function"!=typeof window[b.callback]&&(b.callback="SnowflakeWebviewEventListener")}},a(document).ready(function(){SNOWFLAKE_X.WebviewEventComm.init()})}(jQuery),function(a){SNOWFLAKE_X.Widgets=function(b){return b.init=function(){if(a("#sf-legal").length){a("#sf-footer").waypoint(function(b){"up"===b?a("#sf-legal").removeClass("inline"):a("#sf-legal").addClass("inline")},{offset:"100%"})}b.setDisplay(),b.listeners()},b.setDisplay=function(){a(".sf-etebb").length&&(a(".sf-etebb-slider-wrap:not(.sfProcessed)").each(function(){a(this).find(".sf-slider .sf-slide").length>1&&(a(this).find(".sf-slider").slick({arrows:!1,dots:!0,pauseOnDotsHover:!0,focusOnSelect:!0,autoplay:!0,autoplaySpeed:4e3}),a(this).parents(".sf-etebb:eq(0)").on("focus",function(){a(this).find(".sf-slider").slick("slickPause")}),1==a(this).find(".sf-slider .sf-slide").length&&a(this).find(".sf-slider .sf-slide").attr("tabindex","0"))}),a(".sf-etebb .sf-slide:not(.sfProcessed)").each(function(){if(a(this).addClass("sfProcessed"),a(this).hasClass("has-mobile-bg")&&b.ETEBillboardSlideMobileBG(a(this)),a(this).find(".snowflake-button.is-flex").length){var c="flex_win";SNOWFLAKE.Browser.isMac?c="flex_mac":SNOWFLAKE.Browser.isAndroid?c="flex_and":SNOWFLAKE.Browser.isIOS&&(c="flex_ios"),a(this).find(".snowflake-button."+c).removeClass("sf-hidden").addClass("bigEntrance").fadeIn()}})),a(".sf-promo-slider-wrap:not(.sfProcessed)").each(function(){if(a(this).addClass("sfProcessed"),a(this).find(".sf-slider .sf-slide").length>1&&(a(this).find(".sf-slider").slick({focusOnSelect:!0,autoplay:!0,autoplaySpeed:4e3}),a(this).parents(".sf-widget:eq(0)").on("focus",function(){a(this).find(".sf-slider").slick("slickPause")}),a(this).find(".sf-slider-meta").length)){var b=a(this).find(".sf-slider-meta").data("arrow-o");b>=0&&a(this).find(".sf-slider").find("button").css("opacity",b)}}),a(".sf-billboard-slider-wrap:not(.sfProcessed)").each(function(){a(this).addClass("sfProcessed"),a(this).find(".sf-slide.has-mobile-bg").each(function(){b.BillboardSlideMobileBG(a(this))}),a(this).find(".sf-slider .sf-slide").length>1&&(a(this).find(".sf-slider").slick({arrows:!1,dots:!0,pauseOnDotsHover:!0,focusOnSelect:!0,autoplay:!0,autoplaySpeed:4e3}),a(this).parents(".sf-widget:eq(0)").on("focus",function(){a(this).find(".sf-slider").slick("slickPause")}),1==a(this).find(".sf-slider .sf-slide").length&&a(this).find(".sf-slider .sf-slide").attr("tabindex","0"))}),a(".slick-cloned").attr("aria-hidden","true"),a(".sf-widget.widget-content:not(.sfProcessed)").each(function(){a(this).addClass("sfProcessed"),b.ContentWidgetBG(a(this))}),a(".sf-grid.packery").length&&a(".sf-grid.packery").packery("layout")},b.listeners=function(){a("body").on("sessionMetaComplete",function(a,c){var d=platform="";void 0!==c.country&&(d=c.country),void 0!==c.platform&&(platform=c.platform),b.widgetTargeting(d,platform)}),a(".sf-etebb-slider-wrap .sf-slide.has-mobile-bg").length&&a(window).resize(function(){a(".sf-etebb-slider-wrap .sf-slide.has-mobile-bg").each(function(){b.ETEBillboardSlideMobileBG(a(this))})}),a(".sf-billboard-slider-wrap .sf-slide.has-mobile-bg").length&&a(window).resize(function(){a(".sf-billboard-slider-wrap .sf-slide.has-mobile-bg").each(function(){b.BillboardSlideMobileBG(a(this))})}),a(".sf-widget.widget-content").length&&a(window).resize(function(){a(".sf-widget.widget-content").each(function(){b.ContentWidgetBG(a(this))})}),a(".sf-widget").on("mouseup","a.mobile-links",function(b){b.preventDefault();var c=a(this).attr("href");-1!==c.indexOf("http://")&&(SNOWFLAKE.Browser.isIOS&&""!==a(this).data("href-apple")?c=a(this).data("href-apple"):SNOWFLAKE.Browser.isAndroid&&""!==a(this).data("href-google")&&(c=a(this).data("href-google")),location.href=c)}),a("body").on("animPause",function(b){a(".sf-slider-wrap").each(function(){a(this).find(".sf-slider .sf-slide").length>1&&a(this).find(".sf-slider").slick("slickPause")})})},b.widgetTargeting=function(c,d){""!==c&&a(".sf-geo-target").length&&a(".sf-geo-target").each(function(){var d=a(this).data("sf_geo").split(","),e=a(this).data("sf_geo_type"),f=!1;void 0!==c&&""!=c&&(f=-1!==d.indexOf(c)),"exclude"==e&&f||"include"==e&&!f?a(this).parents(".sf-cell:eq(0)").remove():("exclude"==e&&!f||"include"==e&&f)&&(a(this).hasClass("sf-platform-target")?a(this).data("sf_geo_check","done"):b.targetedWidgetShow(a(this)))}),""!=d&&a(".sf-platform-target").length&&a(".sf-platform-target").each(function(){var c=a(this).data("sf_platform").split(","),d=SF_DISNEYID.Session.platform,e=!0;a(this).hasClass("sf-geo-target")&&(void 0!==a(this).data("sf_geo_check")&&"done"==a(this).data("sf_geo_check")||(e=!1)),e&&(-1!==c.indexOf(d)?b.targetedWidgetShow(a(this)):a(this).parents(".sf-cell:eq(0)").remove())}),b.setDisplay()},b.targetedWidgetShow=function(b){var c=b.html();c=c.replace("\x3c!--",""),c=c.replace("--\x3e",""),c=a.trim(c),b.replaceWith(c)},b.ETEBillboardSlideMobileBG=function(b){var c="";a(window).width()<2*parseInt(snowflake_data.cell_width)&&b.data("bgmobile")&&(c='url("'+b.data("bgmobile")+'")'),b.find(".sf-slide-bg").css("background-image",c)},b.BillboardSlideMobileBG=function(b){var c=b.parents(".sf-cell:eq(0)"),d=b.data("bg");(c.width()<1.5*parseInt(snowflake_data.cell_width)||a(window).width()<2*parseInt(snowflake_data.cell_width)||c.hasClass("sf-g-span-1"))&&(d=b.data("bgmobile")),'url("'+d+'")'!=b.css("background-image")&&b.css("background-image",'url("'+d+'")')},b.ContentWidgetBG=function(b){b.parents(".sf-cell").hasClass("sf-g-span-1")&&b.width()<2*snowflake_data.cell_width||b.parents(".sf-cell").hasClass("sf-g-span-2")&&a("body").width()<3*snowflake_data.cell_width?b.addClass("has-border-radius"):b.removeClass("has-border-radius")},b}(SNOWFLAKE_X.Widgets||{})}(jQuery);